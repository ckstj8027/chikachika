# ChikaChika ν”„λ΅μ νΈ

## π“ ν”„λ΅μ νΈ μ†κ°
ChikaChikaλ” μ–΄λ¦°μ΄λ¥Ό λ€μƒμΌλ΅ μ¬λ°”λ¥Έ μ–‘μΉ μµκ΄€μ„ ν•μ„±ν•  μ μλ„λ΅ λ„μ™€μ£Όλ” μ–‘μΉ λ„μ°λ―Έ μ„λΉ„μ¤μ…λ‹λ‹¤. μ΄ μ„λΉ„μ¤λ” **WebSocket**κ³Ό **REST API**λ¥Ό ν™μ©ν•μ—¬ μ–‘μΉ μƒνƒλ¥Ό μ‹¤μ‹κ°„μΌλ΅ κ΄€λ¦¬ν•κ³ , μ‚¬μ©μμ—κ² μ¬λ°”λ¥Έ μ–‘μΉ μμ„λ¥Ό μ•λ‚΄ν•©λ‹λ‹¤.

---

## π”‘ μ£Όμ” κΈ°λ¥

### 1. μ–‘μΉ μμ„ λ° μƒνƒ κ΄€λ¦¬
- κ° μ–‘μΉ κµ¬μ—­μ λ‹¦μ€ νμμ— λ”°λΌ μƒνƒλ¥Ό κ³„μ‚°ν•μ—¬ μ‹¤μ‹κ°„μΌλ΅ μ—…λ°μ΄νΈν•©λ‹λ‹¤.
- μ–‘μΉ μ§„ν–‰ μƒνƒλ” λ‹¤μ λ„¤ κ°€μ§€ λ‹¨κ³„λ΅ λ‚λ‰©λ‹λ‹¤:
  - **None**: μ–‘μΉλ¥Ό μ‹μ‘ν•μ§€ μ•μ
  - **Little**: μΌλ¶€λ§ λ‹¦μ
  - **Medium**: μ λ° μ΄μƒ λ‹¦μ
  - **Complete**: μ™„λ²½ν λ‹¦μ

### 2. μ–‘μΉ λ°μ΄ν„° κ΄€λ¦¬
- μ–‘μΉ λ°μ΄ν„°λ¥Ό μ„Έμ…μ— μ €μ¥ν•μ—¬ μ‚¬μ©μκ°€ μ–‘μΉ μ¤‘λ‹¨ ν›„ λ‹¤μ‹ μ—°κ²°ν•λ”λΌλ„ μ§„ν–‰ μƒν™©μ„ μ μ§€ν•©λ‹λ‹¤.
- WebSocketμ„ ν†µν•΄ ν΄λΌμ΄μ–ΈνΈμ™€ μ„λ²„ κ°„ μ‹¤μ‹κ°„ λ°μ΄ν„° μ „μ†΅μ„ μ§€μ›ν•©λ‹λ‹¤.

### 3. REST API μ κ³µ
- μ–‘μΉ μƒνƒ μ΄κΈ°ν™”, μ–‘μΉ λ°μ΄ν„° μ—…λ°μ΄νΈ λ“± λ‹¤μ–‘ν• λ™μ‘μ„ μ§€μ›ν•λ” APIλ¥Ό μ κ³µν•©λ‹λ‹¤.

### 4. WebSocket μ‹¤μ‹κ°„ μ•λ¦Ό
- μ–‘μΉ μ§„ν–‰ μƒν™©μ— λ”°λΌ λ‹¤μ κµ¬μ—­μ„ μ•λ‚΄ν•κ±°λ‚ μ™„λ£ λ©”μ‹μ§€λ¥Ό ν΄λΌμ΄μ–ΈνΈμ— μ‹¤μ‹κ°„μΌλ΅ μ „μ†΅ν•©λ‹λ‹¤.

---

## π“‚ ν”„λ΅μ νΈ κµ¬μ΅°

### μ£Όμ” ν¨ν‚¤μ§€

- **`controller`**
  - `ApiController`: REST APIλ¥Ό μ²λ¦¬ν•λ©° ν΄λΌμ΄μ–ΈνΈ μ”μ²­μ— λ€ν• μ‘λ‹µμ„ κ΄€λ¦¬ν•©λ‹λ‹¤.

- **`service`**
  - `TeethBrushedService`: μ–‘μΉ μƒνƒ κ΄€λ¦¬μ™€ λ°μ΄ν„° μ²λ¦¬λ¥Ό λ‹΄λ‹Ήν•©λ‹λ‹¤.

- **`model`**
  - `TeethSource`: ν΄λΌμ΄μ–ΈνΈμ—μ„ μ–‘μΉ λ°μ΄ν„°λ¥Ό μ „μ†΅ν•  λ• μ‚¬μ©λλ” λ°μ΄ν„° λ¨λΈμ…λ‹λ‹¤.
  - `Teeth`: μ„λ²„μ—μ„ ν΄λΌμ΄μ–ΈνΈλ΅ μ‘λ‹µμ„ λ³΄λ‚Ό λ• μ‚¬μ©λλ” λ°μ΄ν„° λ¨λΈμ…λ‹λ‹¤.

- **`configuration`**
  - WebSocket μ„¤μ • λ° μ΄κΈ° λ©”μ‹μ§€ μ „μ†΅ κΈ°λ¥μ„ μ κ³µν•©λ‹λ‹¤.

- **`util`**
  - `TeethSessionManager`: μ‚¬μ©μμ μ–‘μΉ λ°μ΄ν„°λ¥Ό μ„Έμ…μ— μ €μ¥ν•κ³  κ΄€λ¦¬ν•©λ‹λ‹¤.

---

## π” μ£Όμ” ν΄λμ¤ μ„¤λ…

### `ApiController`
- μ–‘μΉ κ΄€λ ¨ λ°μ΄ν„°λ¥Ό μ²λ¦¬ν•λ” REST APIλ¥Ό μ κ³µν•©λ‹λ‹¤.

#### μ κ³µ API:
- **`POST /api/reset`**: μ–‘μΉ λ°μ΄ν„°λ¥Ό μ΄κΈ°ν™”ν•©λ‹λ‹¤.
- **`POST /api/teeth`**: ν΄λΌμ΄μ–ΈνΈμ—μ„ μ–‘μΉ λ°μ΄ν„°λ¥Ό μ „μ†΅λ°›μ•„ μ„λ²„μ—μ„ μƒνƒλ¥Ό κ°±μ‹ ν•κ³  WebSocketμΌλ΅ μ‘λ‹µμ„ μ „μ†΅ν•©λ‹λ‹¤.

### `TeethBrushedService`
- μ–‘μΉ μƒνƒλ¥Ό κ΄€λ¦¬ν•κ³  λ°μ΄ν„°λ¥Ό μ²λ¦¬ν•λ” ν•µμ‹¬ μ„λΉ„μ¤μ…λ‹λ‹¤.

#### μ£Όμ” λ©”μ„λ“:
- `setTeethSectionBrushedLevel`: νΉμ • κµ¬μ—­μ μ–‘μΉ μƒνƒλ¥Ό μ—…λ°μ΄νΈν•©λ‹λ‹¤.
- `getTeethSectionBrushedLevel`: ν„μ¬ μ–‘μΉ μƒνƒλ¥Ό λ°ν™ν•©λ‹λ‹¤.
- `getNeedToBrushSectionIdx`: λ‹¤μμ— λ‹¦μ•„μ•Ό ν•  κµ¬μ—­μ μΈλ±μ¤λ¥Ό κ³„μ‚°ν•©λ‹λ‹¤.
- `resetBrushedInfo`: μ–‘μΉ μƒνƒλ¥Ό μ΄κΈ°ν™”ν•©λ‹λ‹¤.

### `CustomWebSocketHandler`
- WebSocket μ—°κ²°μ„ κ΄€λ¦¬ν•λ©° ν΄λΌμ΄μ–ΈνΈμ™€ μ‹¤μ‹κ°„μΌλ΅ λ°μ΄ν„°λ¥Ό μ£Όκ³ λ°›μµλ‹λ‹¤.

#### μ£Όμ” λ©”μ„λ“:
- `afterConnectionEstablished`: ν΄λΌμ΄μ–ΈνΈκ°€ μ—°κ²°λλ©΄ μ΄κΈ° λ©”μ‹μ§€λ¥Ό μ „μ†΅ν•©λ‹λ‹¤.
- `sendMessage`: μ„λ²„μ—μ„ μƒμ„±λ λ©”μ‹μ§€λ¥Ό ν΄λΌμ΄μ–ΈνΈμ— μ „μ†΅ν•©λ‹λ‹¤.

---

## π“„ API λ…μ„Έ

### **POST /api/reset**
- **μ„¤λ…**: μ–‘μΉ λ°μ΄ν„°λ¥Ό μ΄κΈ°ν™”ν•©λ‹λ‹¤.

#### μ‘λ‹µ:
- **μ„±κ³µ**: μ–‘μΉ λ°μ΄ν„°κ°€ μ΄κΈ°ν™”λ©λ‹λ‹¤.

---

### **POST /api/teeth**
- **μ„¤λ…**: νΉμ • κµ¬μ—­μ μ–‘μΉ μƒνƒλ¥Ό μ„λ²„μ— μ—…λ°μ΄νΈν•©λ‹λ‹¤.

#### Request Body:
```json
{
  "brushedSection": "UF_OUTSIDE",
  "brushedCnt": 3
}
